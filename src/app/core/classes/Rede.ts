export class Rede{
  grafo:Array<any>;
  p:number
  tamanhoReticulado:number;
  configuracaoInicial:Array<number>;
  tamanhoRegra:number;
  regra:any;
  tamanhoVizinhanca:number;
  estadoAtual:Array<number>;
  vetoresDiagrama:Array<any>;
  espacosDeTempo:number;
  constructor(tamanhoReticulado:number,tamanhoRegra:number,espacosDeTempo:number,p:number,configuracaoInicial?:Array<number>,isFixa?:boolean,numeroRede?:number){
    this.p = p
    this.espacosDeTempo = espacosDeTempo;
    this.tamanhoReticulado = tamanhoReticulado;
    this.configuracaoInicial = configuracaoInicial
    this.tamanhoRegra = tamanhoRegra;
    this.tamanhoVizinhanca = 3
    this.regra = this.dec2bin(this.tamanhoRegra,this.tamanhoVizinhanca)
    this.estadoAtual = this.configuracaoInicial;
    this.criarSmallWorld(isFixa,numeroRede)
    this.vetoresDiagrama = new Array(0)
    this.vetoresDiagrama.push(this.estadoAtual)

    for (let i = 0; i < this.espacosDeTempo; i++) {
      this.estadoAtual = this.evoluir(this.estadoAtual)
      this.vetoresDiagrama.push(this.estadoAtual)
    }





}
evoluir(estadoAtual){
  let n = estadoAtual.length;
  let proximoEstado = new Array(this.tamanhoReticulado)
  for (let i = 0; i < n; i++) {

    let esq = this.grafo[i][0]
    let dir = this.grafo[i][1]
    let pontoDeRegra =""+estadoAtual[esq]+""+estadoAtual[i]+""+estadoAtual[dir];
    let indice = this.bin2dec(pontoDeRegra);
    proximoEstado[i] = +this.regra[indice]
  }
  return proximoEstado;
}
exibir():void{
  console.log("Tamanho: "+this.tamanhoReticulado);
  console.log("Inicio: "+this.configuracaoInicial)



}

dec2bin(dec,tamanho){
  let regraEmBinario =  (dec >>> 0).toString(2);

  let regra = new Array(Math.pow(2,tamanho))

  let k = regraEmBinario.length-1;

  for (let i = regra.length-1; i >= 0; i--) {
    if(k>=0){
      regra[i] = regraEmBinario[k]
      k--;
    }
    else
      regra[i] = 0;
  }
  return regra;
}
bin2dec(num) {
let dec = 0;
for (let i = 0; i < num.length; i++) {
    if (num[num.length - (i + 1)] === '1') {
        dec += 2 ** i;
    }
}
return dec;
}


aleatorizar(){
  let n = this.grafo.length
  for (let i = 0; i < n; i++) {
    for (let j = 0; j < this.grafo[i].length; j++) {
      let numAleatorio = Math.random()
      if(numAleatorio<this.p){
        let sorteioNovoNo = Math.floor((this.grafo.length-1) * Math.random());
        while(sorteioNovoNo==this.grafo[i][j])
           sorteioNovoNo = Math.floor((this.grafo.length-1) * Math.random());

         this.grafo[i][j]= sorteioNovoNo

      }

    }

  }



}

conectarTodosOsNos(){
  let n = this.grafo.length
  for (let i = 0; i < n; i++) {
    let esq = ((i-1) % n + n) % n
    let dir = ((i+1) % n + n) % n
    this.grafo[i].push(esq,dir)
  }
}

criarSmallWorld(isFixa?:boolean,numeroRede?:number){

  if(!isFixa){
    this.grafo = []
    for (let index = 0; index < this.tamanhoReticulado; index++)
       this.grafo.push(new Array());
    this.conectarTodosOsNos();
    this.aleatorizar()


  }
  else {

    switch (numeroRede) {
      case 1:
        this.grafo = grafo1
        break;

      case 2:
        this.grafo = grafo2
        break;

      case 3:
        this.grafo = grafo3
        break;

      case 4:
        this.grafo = grafo4
        break;

      default:
        break;
    }

  }
  console.log(this)
}

}


let grafo1 = [
  [
    99,
    1
  ],
  [
    0,
    2
  ],
  [
    1,
    3
  ],
  [
    92,
    4
  ],
  [
    3,
    5
  ],
  [
    4,
    6
  ],
  [
    5,
    7
  ],
  [
    6,
    8
  ],
  [
    7,
    9
  ],
  [
    8,
    2
  ],
  [
    9,
    11
  ],
  [
    95,
    12
  ],
  [
    11,
    13
  ],
  [
    12,
    14
  ],
  [
    13,
    15
  ],
  [
    14,
    16
  ],
  [
    15,
    17
  ],
  [
    16,
    18
  ],
  [
    17,
    19
  ],
  [
    18,
    20
  ],
  [
    19,
    21
  ],
  [
    91,
    22
  ],
  [
    21,
    23
  ],
  [
    22,
    24
  ],
  [
    23,
    25
  ],
  [
    24,
    26
  ],
  [
    25,
    27
  ],
  [
    26,
    28
  ],
  [
    27,
    29
  ],
  [
    28,
    30
  ],
  [
    29,
    68
  ],
  [
    90,
    32
  ],
  [
    31,
    33
  ],
  [
    32,
    34
  ],
  [
    33,
    35
  ],
  [
    34,
    36
  ],
  [
    35,
    71
  ],
  [
    36,
    38
  ],
  [
    37,
    39
  ],
  [
    38,
    40
  ],
  [
    39,
    41
  ],
  [
    40,
    42
  ],
  [
    41,
    43
  ],
  [
    42,
    44
  ],
  [
    43,
    45
  ],
  [
    26,
    46
  ],
  [
    45,
    47
  ],
  [
    46,
    48
  ],
  [
    47,
    49
  ],
  [
    48,
    50
  ],
  [
    45,
    51
  ],
  [
    50,
    52
  ],
  [
    51,
    53
  ],
  [
    52,
    54
  ],
  [
    53,
    55
  ],
  [
    85,
    56
  ],
  [
    55,
    57
  ],
  [
    56,
    58
  ],
  [
    57,
    59
  ],
  [
    58,
    60
  ],
  [
    59,
    61
  ],
  [
    60,
    62
  ],
  [
    61,
    8
  ],
  [
    62,
    64
  ],
  [
    63,
    65
  ],
  [
    64,
    48
  ],
  [
    65,
    67
  ],
  [
    66,
    68
  ],
  [
    67,
    69
  ],
  [
    68,
    70
  ],
  [
    69,
    71
  ],
  [
    70,
    72
  ],
  [
    71,
    73
  ],
  [
    72,
    74
  ],
  [
    73,
    75
  ],
  [
    74,
    76
  ],
  [
    75,
    16
  ],
  [
    76,
    78
  ],
  [
    77,
    52
  ],
  [
    51,
    80
  ],
  [
    79,
    81
  ],
  [
    80,
    82
  ],
  [
    40,
    83
  ],
  [
    21,
    84
  ],
  [
    27,
    85
  ],
  [
    84,
    86
  ],
  [
    85,
    87
  ],
  [
    86,
    88
  ],
  [
    87,
    89
  ],
  [
    88,
    89
  ],
  [
    89,
    68
  ],
  [
    90,
    92
  ],
  [
    91,
    93
  ],
  [
    92,
    94
  ],
  [
    93,
    95
  ],
  [
    94,
    96
  ],
  [
    95,
    97
  ],
  [
    96,
    98
  ],
  [
    97,
    99
  ],
  [
    98,
    0
  ]
]
let grafo2 =  [
  [
    99,
    1
  ],
  [
    0,
    2
  ],
  [
    1,
    3
  ],
  [
    2,
    53
  ],
  [
    3,
    5
  ],
  [
    4,
    6
  ],
  [
    5,
    7
  ],
  [
    6,
    8
  ],
  [
    7,
    9
  ],
  [
    8,
    10
  ],
  [
    9,
    11
  ],
  [
    10,
    12
  ],
  [
    11,
    13
  ],
  [
    12,
    14
  ],
  [
    13,
    15
  ],
  [
    14,
    16
  ],
  [
    15,
    17
  ],
  [
    16,
    18
  ],
  [
    17,
    19
  ],
  [
    18,
    20
  ],
  [
    19,
    21
  ],
  [
    20,
    22
  ],
  [
    21,
    23
  ],
  [
    22,
    24
  ],
  [
    23,
    25
  ],
  [
    24,
    26
  ],
  [
    25,
    27
  ],
  [
    26,
    28
  ],
  [
    27,
    29
  ],
  [
    28,
    30
  ],
  [
    29,
    31
  ],
  [
    30,
    32
  ],
  [
    31,
    33
  ],
  [
    32,
    34
  ],
  [
    33,
    35
  ],
  [
    34,
    36
  ],
  [
    35,
    37
  ],
  [
    36,
    41
  ],
  [
    37,
    34
  ],
  [
    38,
    40
  ],
  [
    39,
    41
  ],
  [
    40,
    42
  ],
  [
    41,
    43
  ],
  [
    42,
    44
  ],
  [
    43,
    45
  ],
  [
    44,
    46
  ],
  [
    45,
    55
  ],
  [
    46,
    48
  ],
  [
    47,
    88
  ],
  [
    48,
    85
  ],
  [
    49,
    27
  ],
  [
    50,
    52
  ],
  [
    51,
    53
  ],
  [
    67,
    54
  ],
  [
    53,
    55
  ],
  [
    54,
    56
  ],
  [
    55,
    57
  ],
  [
    56,
    58
  ],
  [
    57,
    59
  ],
  [
    58,
    60
  ],
  [
    59,
    61
  ],
  [
    60,
    62
  ],
  [
    61,
    63
  ],
  [
    62,
    64
  ],
  [
    63,
    65
  ],
  [
    64,
    66
  ],
  [
    65,
    67
  ],
  [
    66,
    68
  ],
  [
    25,
    11
  ],
  [
    68,
    70
  ],
  [
    69,
    52
  ],
  [
    70,
    72
  ],
  [
    71,
    73
  ],
  [
    72,
    37
  ],
  [
    73,
    75
  ],
  [
    74,
    76
  ],
  [
    2,
    77
  ],
  [
    76,
    78
  ],
  [
    77,
    31
  ],
  [
    78,
    80
  ],
  [
    79,
    98
  ],
  [
    80,
    82
  ],
  [
    81,
    83
  ],
  [
    82,
    84
  ],
  [
    83,
    85
  ],
  [
    84,
    86
  ],
  [
    85,
    87
  ],
  [
    86,
    88
  ],
  [
    75,
    89
  ],
  [
    88,
    73
  ],
  [
    89,
    91
  ],
  [
    90,
    92
  ],
  [
    33,
    93
  ],
  [
    92,
    94
  ],
  [
    93,
    95
  ],
  [
    45,
    96
  ],
  [
    95,
    97
  ],
  [
    96,
    98
  ],
  [
    97,
    99
  ],
  [
    98,
    0
  ]
]

let grafo3 = [
  [
    99,
    1
  ],
  [
    0,
    2
  ],
  [
    1,
    3
  ],
  [
    2,
    4
  ],
  [
    3,
    5
  ],
  [
    4,
    6
  ],
  [
    5,
    7
  ],
  [
    34,
    8
  ],
  [
    7,
    9
  ],
  [
    8,
    10
  ],
  [
    9,
    11
  ],
  [
    10,
    12
  ],
  [
    11,
    13
  ],
  [
    12,
    14
  ],
  [
    13,
    15
  ],
  [
    82,
    16
  ],
  [
    15,
    17
  ],
  [
    16,
    18
  ],
  [
    17,
    19
  ],
  [
    18,
    20
  ],
  [
    19,
    21
  ],
  [
    20,
    22
  ],
  [
    21,
    23
  ],
  [
    22,
    24
  ],
  [
    23,
    25
  ],
  [
    24,
    26
  ],
  [
    25,
    27
  ],
  [
    26,
    28
  ],
  [
    27,
    29
  ],
  [
    28,
    30
  ],
  [
    51,
    31
  ],
  [
    30,
    32
  ],
  [
    31,
    33
  ],
  [
    32,
    34
  ],
  [
    33,
    35
  ],
  [
    34,
    36
  ],
  [
    35,
    37
  ],
  [
    36,
    38
  ],
  [
    49,
    39
  ],
  [
    94,
    40
  ],
  [
    39,
    41
  ],
  [
    40,
    42
  ],
  [
    41,
    22
  ],
  [
    42,
    44
  ],
  [
    43,
    45
  ],
  [
    44,
    46
  ],
  [
    45,
    47
  ],
  [
    46,
    48
  ],
  [
    47,
    49
  ],
  [
    48,
    50
  ],
  [
    49,
    51
  ],
  [
    50,
    56
  ],
  [
    51,
    58
  ],
  [
    52,
    54
  ],
  [
    53,
    48
  ],
  [
    54,
    56
  ],
  [
    87,
    57
  ],
  [
    56,
    58
  ],
  [
    57,
    59
  ],
  [
    22,
    60
  ],
  [
    59,
    84
  ],
  [
    60,
    62
  ],
  [
    61,
    63
  ],
  [
    62,
    83
  ],
  [
    63,
    65
  ],
  [
    64,
    66
  ],
  [
    65,
    67
  ],
  [
    66,
    68
  ],
  [
    67,
    69
  ],
  [
    68,
    70
  ],
  [
    69,
    71
  ],
  [
    70,
    72
  ],
  [
    71,
    73
  ],
  [
    72,
    74
  ],
  [
    73,
    75
  ],
  [
    74,
    76
  ],
  [
    75,
    77
  ],
  [
    76,
    78
  ],
  [
    77,
    79
  ],
  [
    78,
    80
  ],
  [
    79,
    81
  ],
  [
    80,
    82
  ],
  [
    81,
    83
  ],
  [
    82,
    84
  ],
  [
    70,
    85
  ],
  [
    84,
    14
  ],
  [
    85,
    87
  ],
  [
    86,
    88
  ],
  [
    87,
    89
  ],
  [
    88,
    90
  ],
  [
    89,
    91
  ],
  [
    90,
    53
  ],
  [
    91,
    93
  ],
  [
    92,
    94
  ],
  [
    93,
    95
  ],
  [
    94,
    96
  ],
  [
    95,
    97
  ],
  [
    24,
    98
  ],
  [
    97,
    99
  ],
  [
    98,
    0
  ]
]

let grafo4 =[
  [
    99,
    1
  ],
  [
    0,
    2
  ],
  [
    90,
    3
  ],
  [
    2,
    4
  ],
  [
    3,
    88
  ],
  [
    4,
    6
  ],
  [
    5,
    7
  ],
  [
    6,
    8
  ],
  [
    7,
    9
  ],
  [
    61,
    90
  ],
  [
    9,
    53
  ],
  [
    10,
    12
  ],
  [
    11,
    13
  ],
  [
    12,
    14
  ],
  [
    13,
    15
  ],
  [
    92,
    20
  ],
  [
    15,
    17
  ],
  [
    16,
    18
  ],
  [
    17,
    98
  ],
  [
    18,
    20
  ],
  [
    19,
    21
  ],
  [
    20,
    22
  ],
  [
    21,
    23
  ],
  [
    22,
    24
  ],
  [
    23,
    7
  ],
  [
    24,
    26
  ],
  [
    25,
    27
  ],
  [
    26,
    49
  ],
  [
    27,
    29
  ],
  [
    28,
    30
  ],
  [
    29,
    31
  ],
  [
    30,
    32
  ],
  [
    31,
    33
  ],
  [
    32,
    34
  ],
  [
    33,
    35
  ],
  [
    34,
    36
  ],
  [
    35,
    37
  ],
  [
    36,
    38
  ],
  [
    37,
    39
  ],
  [
    84,
    40
  ],
  [
    39,
    41
  ],
  [
    40,
    42
  ],
  [
    76,
    43
  ],
  [
    42,
    44
  ],
  [
    43,
    45
  ],
  [
    44,
    46
  ],
  [
    45,
    47
  ],
  [
    46,
    48
  ],
  [
    47,
    49
  ],
  [
    48,
    50
  ],
  [
    49,
    51
  ],
  [
    50,
    52
  ],
  [
    77,
    80
  ],
  [
    52,
    54
  ],
  [
    96,
    55
  ],
  [
    12,
    56
  ],
  [
    55,
    57
  ],
  [
    56,
    58
  ],
  [
    57,
    59
  ],
  [
    58,
    60
  ],
  [
    59,
    43
  ],
  [
    60,
    62
  ],
  [
    61,
    63
  ],
  [
    62,
    64
  ],
  [
    63,
    65
  ],
  [
    64,
    66
  ],
  [
    65,
    67
  ],
  [
    66,
    68
  ],
  [
    67,
    29
  ],
  [
    68,
    70
  ],
  [
    69,
    71
  ],
  [
    70,
    72
  ],
  [
    71,
    82
  ],
  [
    72,
    74
  ],
  [
    73,
    75
  ],
  [
    74,
    76
  ],
  [
    75,
    77
  ],
  [
    76,
    78
  ],
  [
    77,
    20
  ],
  [
    78,
    80
  ],
  [
    79,
    81
  ],
  [
    80,
    82
  ],
  [
    81,
    83
  ],
  [
    82,
    84
  ],
  [
    83,
    85
  ],
  [
    84,
    86
  ],
  [
    85,
    87
  ],
  [
    86,
    88
  ],
  [
    87,
    89
  ],
  [
    88,
    90
  ],
  [
    89,
    91
  ],
  [
    90,
    62
  ],
  [
    91,
    93
  ],
  [
    92,
    94
  ],
  [
    29,
    95
  ],
  [
    94,
    96
  ],
  [
    95,
    97
  ],
  [
    96,
    98
  ],
  [
    97,
    99
  ],
  [
    98,
    0
  ]
]

